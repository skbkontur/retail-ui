export default {
  title: '_TestRetreat',
};

export const ButtonWithIcon = () => {
  return <Button>Hello ðŸ‘‹</Button>;
};

/**
 *  Button. Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œhoverâ€
 *
 *  0. Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ ButtonWithIcon
 *  1. ÐÐ°Ð¹Ñ‚Ð¸ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ
 *  2. ðŸ“¸ Ð´ÐµÑ„Ð¾Ð»Ñ‚Ð½Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ
 *  3. ÐÐ°Ð²ÐµÑÑ‚Ð¸ Ð¼Ñ‹ÑˆÑŒ Ð½Ð° ÐšÐ½Ð¾Ð¿ÐºÑƒ
 *  4. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œhoverâ€
 *  5. ÐÐ°Ð±Ð»ÑŽÐ´Ð°ÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ñ†Ð²ÐµÑ‚Ð° Ñ„Ð¾Ð½Ð°
 *
 *  Profit!
 */

ButtonWithIcon.story = {
  parameters: {
    creevey: {
      tests: {
        async hover(this: { browser: WebDriver }) {
          // 1. Ð½Ð°Ñ…Ð¾Ð´Ð¸Ð¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚Ð°
          const element = await this.browser.findElement({ css: '#test-element' });
          // Ð½Ð°Ñ…Ð¾Ð´Ð¸Ð¼ ÐºÐ½Ð¾Ð¿ÐºÑƒ
          const button = await this.browser.findElement({ css: 'button' });

          // 2. Ð´ÐµÐ»Ð°ÐµÐ¼ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ "Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ"
          const idle = await element.takeScreenshot();

          // 3. Ð½Ð°Ð²Ð¾Ð´Ð¸Ð¼ ÑƒÐºÐ°Ð·Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ñ‹ÑˆÐ¸
          await this.browser
            .actions({ bridge: true })
            .move({ origin: button })
            .perform();

          // 4. Ð´ÐµÐ»Ð°ÐµÐ¼ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ "Ð¿Ñ€Ð¸ Ð½Ð°Ð²ÐµÐ´ÐµÐ½Ð¸Ð¸"
          const hover = await element.takeScreenshot();

          // 5. ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°ÐµÐ¼ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹
          await expect({ idle, hover }).to.matchImages();
        },
      },
    },
  },
};

export const BasicLink = () => {
  return (
    <div style={{ marginTop: '20px' }}>
      <Link href='#'>Base link</Link>
    </div>
  );
};

/**
 *  Link. ÐšÐ»Ð¸Ðº Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ
 *
 *  0. Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ BasicLink
 *  1. ÐÐ°Ð¹Ñ‚Ð¸ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ
 *  2. ÐÐ°Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð½Ð° ÑÑÑ‹Ð»ÐºÑƒ
 *  3. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ "hover"
 *  4. ÐÐ°Ð¶Ð°Ñ‚ÑŒ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ MOUSE_DOWN
 *  5. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œÐ·Ð°Ð¶Ð°Ñ‚Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ° Ð¼Ñ‹ÑˆÐ¸â€
 *  4. ÐÐ°Ð¶Ð°Ñ‚ÑŒ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ MOUSE_UP
 *  5. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œÐºÐ»Ð¸ÐºÐ½ÑƒÐ»Ð¸ Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµâ€
 *
 *  Profit!
 */

BasicLink.story = {
  parameters: {
    creevey: {
      tests: {
        async itemSelected(this: { browser: WebDriver }) {
          const element = await this.browser.findElement({ css: '#test-element' });
          const link = await this.browser.findElement({ css: 'a' });

          const started = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .move({ origin: link })
            .perform();

          const hovered = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .press()
            .perform();

          const pressed = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .click()
            .perform();

          const clicked = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .move({ x: 0, y: 0 })
            .perform();

          const activated = await element.takeScreenshot();

          await expect({ started, hovered, pressed, clicked, activated }).to.matchImages();
        },
      },
    },
  },
};

export const BasicAutocomplete = () => {
  const [value, updateValue] = React.useState('');
  return (
    <div style={{ padding: '4px 200px 200px 4px' }}>
      <Autocomplete source={['one', 'two', 'three']} value={value} onValueChange={updateValue}/>
    </div>
  );
};

/**
 *  Autocomplete. Ð’Ñ‹Ð±Ð¾Ñ€ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ð¾ Enter
 *
 *  0. Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ BasicAutocomplete
 *  1. ÐÐ°Ð¹Ñ‚Ð¸ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ
 *  2. Ð¤Ð¾ÐºÑƒÑ Ð½Ð° Ð¿Ð¾Ð»Ðµ Ð²Ð²Ð¾Ð´Ð°
 *  3. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ "Ð² Ñ„Ð¾ÐºÑƒÑÐµ"
 *  4. Ð’Ð²ÐµÑÑ‚Ð¸ ÑÐ¸Ð¼Ð²Ð¾Ð» "Ð¾"
 *  5. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œÐ²Ð²ÐµÐ´ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»â€
 *  6. ÐÐ°Ð¶Ð°Ñ‚ÑŒ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ ARROW_DOWN
 *  7. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œÐ¿Ð¾Ð´ÑÐ²ÐµÑ‡ÐµÐ½ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚â€
 *  8. ÐÐ°Ð¶Ð°Ñ‚ÑŒ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ ENTER
 *  9. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œÐ²Ñ‹Ð±Ñ€Ð°Ð½ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚â€
 *
 *  Profit!
 */

BasicAutocomplete.story = {
  parameters: {
    creevey: {
      tests: {
        async itemSelected(this: { browser: WebDriver }) {
          const element = await this.browser.findElement({ css: '#test-element' });
          const input = await this.browser.findElement({ css: '[data-comp-name~=Autocomplete]' });

          await this.browser
            .actions({ bridge: true })
            .click(input)
            .perform();

          const focused = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .sendKeys('o')
            .perform();

          const typed = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .sendKeys(Key.ARROW_DOWN)
            .perform();

          const highlighted = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .sendKeys(Key.ENTER)
            .perform();

          const selected = await element.takeScreenshot();

          await expect({ focused, typed, highlighted, selected }).to.matchImages();
        },
      },
    },
  },
};

export const BasicToggle = () => {
  const initialState = false;
  const [checked, checkSet] = React.useState(initialState);
  const toggleCheck = () => {
    checkSet(!checked);
  };
  return (
    <div>
      <Toggle checked={checked} onChange={toggleCheck} /> {checked ? 'On' : 'Off'}
    </div>
  );
};

/**
 * Toggle. ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ
 *
 *  0. Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ BasicToggle
 *  1. ÐÐ°Ð¹Ñ‚Ð¸ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ
 *  2. ðŸ“¸ Ð´ÐµÑ„Ð¾Ð»Ñ‚Ð½Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ
 *  3. ÐÐ°Ð²ÐµÑÑ‚Ð¸ Ð¼Ñ‹ÑˆÑŒ Ð½Ð° Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ
 *  4. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œhoverâ€
 *  5. Ð¤Ð¾ÐºÑƒÑ Ð½Ð° Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»Ðµ
 *  6. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ "Ð² Ñ„Ð¾ÐºÑƒÑÐµ"
 *  7. ÐšÐ»Ð¸ÐºÐ½ÑƒÑ‚ÑŒ Ð½Ð° Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ
 *  8. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ "Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½"
 *  Profit!
 */

BasicToggle.story = {
  parameters: {
    creevey: {
      tests: {
        async toggleItem(this: { browser: WebDriver }) {
          const element = await this.browser.findElement({ css: '#test-element' });
          const inputLabel = await this.browser.findElement({ css: 'label' });

          const defaultToggle = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .move({ origin: inputLabel })
            .perform();

          const hoverToggle = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .move({ origin: inputLabel })
            .press()
            .perform();

          const focusToggle = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .click(inputLabel)
            .perform();

          const toggled = await element.takeScreenshot();

          await expect({ defaultToggle, hoverToggle, focusToggle, toggled }).to.matchImages();
        },
      },
    },
  },
};

export const SimpleTabs = () => {
  const initialState = 'first';
  const [current, currentSet] = React.useState(initialState);
  const changeHandler = (value: string) => currentSet(value);

  return (
    <Tabs value={current} onValueChange={changeHandler}>
      <Tabs.Tab id="first">first</Tabs.Tab>
      <Tabs.Tab disabled id="second">
        second (disabled)
      </Tabs.Tab>
      <Tabs.Tab id="third">third</Tabs.Tab>
    </Tabs>
  );
};

/**
 * Tabs. Ð’Ñ‹Ð±Ð¾Ñ€ Ð½ÑƒÐ¶Ð½Ð¾Ð³Ð¾ Ñ‚Ð°Ð±Ð°
 *
 *  0. Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ BasicToggle
 *  1. ÐÐ°Ð¹Ñ‚Ð¸ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ
 *  2. ðŸ“¸ Ð´ÐµÑ„Ð¾Ð»Ñ‚Ð½Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ
 *  3. ÐÐ°Ð²ÐµÑÑ‚Ð¸ Ð¼Ñ‹ÑˆÑŒ Ð½Ð° Ñ‚Ð°Ð±
 *  4. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ â€œhoverâ€
 *  5. Ð¤Ð¾ÐºÑƒÑ Ð½Ð° Ñ‚Ð°Ð±Ðµ
 *  6. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ "Ð² Ñ„Ð¾ÐºÑƒÑÐµ"
 *  7. ÐšÐ»Ð¸ÐºÐ½ÑƒÑ‚ÑŒ Ð½Ð° Ñ‚Ð°Ð±
 *  8. ðŸ“¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ "Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½"
 *
 *  Profit!
 */

SimpleTabs.story = {
  parameters: {
    creevey: {
      tests: {
        async selectTab(this: { browser: WebDriver }) {
          const element = await this.browser.findElement({ css: '#test-element' });
          const thirdTab = await this.browser.findElement({ css: 'a[data-prop-id~=third]' });

          const defaultToggle = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .move({ origin: thirdTab })
            .perform();

          const hoverTab = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .click(thirdTab)
            .perform();

          const activeTabChanged = await element.takeScreenshot();

          await expect({ defaultToggle, hoverTab, activeTabChanged }).to.matchImages();
        },

        async selectDisabledTab(this: { browser: WebDriver }) {
          const element = await this.browser.findElement({ css: '#test-element' });
          const secondTab = await this.browser.findElement({ css: 'a[data-prop-id~=second]' });

          const defaultToggle = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .move({ origin: secondTab })
            .perform();

          const hoverTab = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .click(secondTab)
            .perform();

          const activeTabChanged = await element.takeScreenshot();

          await expect({ defaultToggle, hoverTab, activeTabChanged }).to.matchImages();
        },

        async selectActiveTab(this: { browser: WebDriver }) {
          const element = await this.browser.findElement({ css: '#test-element' });
          const firstTab = await this.browser.findElement({ css: 'a[data-prop-id~=first]' });

          const defaultToggle = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .move({ origin: firstTab })
            .perform();

          const hoverTab = await element.takeScreenshot();

          await this.browser
            .actions({ bridge: true })
            .click(firstTab)
            .perform();

          const activeTabChanged = await element.takeScreenshot();

          await expect({ defaultToggle, hoverTab, activeTabChanged }).to.matchImages();
        },
      },
    },
  },
};

/**
 * ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚, Ð¿Ð¾ÐºÐ° Ð¿Ñ€Ð¾Ð¹Ð´Ñ‘Ñ‚ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ðµ ÐºÐ¾Ð»-Ð²Ð¾ Ð¼Ð¸Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´
 *
 * @param driver
 * @param msTime
 */
async function sleep(driver: WebDriver, msTime: number) {
  let isDone = false;
  setTimeout(() => isDone = true, msTime);
  await driver.wait(() => isDone, msTime);
}
